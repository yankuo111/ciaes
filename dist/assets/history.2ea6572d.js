import{_ as S,s as A,e as D,o as r,l as g,q as _,H as v,D as h,T as C,F as E,E as P,a1 as w,Q as V,L as $,p as N,m as T}from"./index.8c5864de.js";import{s as m}from"./index.d6bd2086.js";/* empty css              */import{I as b}from"./index.72a4dedb.js";import"./index.6925981e.js";import{s as q}from"./function-call.ed32c8d0.js";import{S as M,E as U}from"./index.dac30710.js";import{C as z}from"./index.8ebbac1f.js";import{L as G}from"./index.8f4b3c75.js";import"./index.3e2c8ef6.js";import"./index.5ec7378f.js";const H=l=>(N("data-v-79f22f0d"),l=l(),T(),l),Q={class:"nav"},R=H(()=>_("div",{style:{height:"54px"}},null,-1)),j={class:"list-contaner"},J=A({__name:"history",setup(l){let c=V();const{appContext:y}=$(),u=y.config.globalProperties,e=D({search:"",loading:!1,finished:!1,historyList:[],totalCount:1,currentPage:1}),L=()=>{c.push("/h5/v2/historySearch")},f=()=>{e.loading=!0;let t={page:e.currentPage};return new Promise((o,n)=>{u.axios.post(u.$api.sessionList,t).then(i=>{const{data:s,code:d,msg:p}=i.data;d==0?(s.currentPage===s.totalPage?e.finished=!0:e.currentPage++,e.historyList=e.historyList.concat(s.data),e.totalCount=s.totalCount,o(!0)):(e.totalCount=0,m(p),c.replace("/v2/login"),n()),e.loading=!1})})};f();const B=t=>{let o={sessionId:e.historyList[t].sessionId};u.axios.post(u.$api.delSession,o).then(n=>{const{code:i,msg:s}=n.data;i==0?(m("\u5220\u9664\u6210\u529F"),e.historyList.splice(t,1)):m(s),e.loading=!1})},F=t=>{q({title:"\u6E29\u99A8\u63D0\u793A",confirmButtonColor:"#22ad72",message:"\u786E\u8BA4\u5220\u9664\u672C\u6761\u8BB0\u5F55\u4E48\uFF1F"}).then(()=>{B(t)}).catch(()=>{})},k=t=>{t?c.push({path:"/h5/v2/chat",query:{sessionId:t}}):c.push("/h5/v2/index")};return(t,o)=>{const n=M,i=b,s=z,d=G,p=U;return r(),g("div",null,[_("div",Q,[v(n,{modelValue:e.search,"onUpdate:modelValue":o[0]||(o[0]=a=>e.search=a),disabled:"",onClick:L,shape:"round",placeholder:"\u641C\u7D22\u804A\u5929\u8BB0\u5F55"},null,8,["modelValue"])]),R,_("div",j,[e.historyList.length!==0?(r(),h(d,{key:0,loading:e.loading,"onUpdate:loading":o[1]||(o[1]=a=>e.loading=a),finished:e.finished,"finished-text":"\u6CA1\u6709\u66F4\u591A\u4E86",onLoad:f},{default:C(()=>[(r(!0),g(E,null,P(e.historyList,(a,x)=>(r(),h(s,{key:a.saveTime,title:a.sessionName,onClick:I=>k(a.sessionId),icon:"chat-o"},{"right-icon":C(()=>[v(i,{name:"delete-o",color:"#a9a6a6",class:"search-icon",onClick:w(I=>F(x),["stop"])},null,8,["onClick"])]),_:2},1032,["title","onClick"]))),128))]),_:1},8,["loading","finished"])):(r(),h(p,{key:1,"image-size":"150",description:"\u6CA1\u6709\u4FDD\u5B58\u804A\u5929\u8BB0\u5F55"}))])])}}});var ne=S(J,[["__scopeId","data-v-79f22f0d"]]);export{ne as default};
