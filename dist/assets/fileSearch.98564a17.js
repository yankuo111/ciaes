import{_ as P,s as V,e as q,r as T,o as n,l as r,q as a,H as d,T as m,y as Y,A as g,I as S,F as y,E as v,G as M,x as C,D as w,B as z,Q as G,L as J,p as O,m as U}from"./index.8c5864de.js";/* empty css              */import{I as K}from"./index.72a4dedb.js";import{s as Q}from"./index.d6bd2086.js";import"./index.6925981e.js";import{B as R}from"./index.3e2c8ef6.js";import{S as j,E as W}from"./index.dac30710.js";import{C as X}from"./index.8ebbac1f.js";import{L as Z}from"./index.8f4b3c75.js";import{s as ee}from"./function-call.ed32c8d0.js";import"./index.5ec7378f.js";const k=l=>(O("data-v-da500544"),l=l(),U(),l),te={class:"nav"},oe=k(()=>a("div",{style:{height:"54px"}},null,-1)),se={class:"history-search"},ae={class:"history-title flex flex_center flex_between"},ne=k(()=>a("span",null,"\u5386\u53F2\u641C\u7D22",-1)),ie={class:"history-item"},re=["onClick"],le={class:"list-contaner"},ce={key:0,class:"chat-empty"},de=V({__name:"fileSearch",setup(l){G();const{appContext:x}=J(),i=x.config.globalProperties,e=q({search:"",knowledgeList:[],historySearch:[],isShowHistoy:!0,finished:!1,loading:!1,currentPage:1}),F=T(""),I=i.$common.DateFormat;let p=localStorage.getItem("fileSearch");p&&(e.historySearch=JSON.parse(p));const c=()=>{!e.search||(e.loading=!0,e.historySearch.unshift(e.search),e.historySearch=[...new Set(e.historySearch)],localStorage.setItem("fileSearch",JSON.stringify(e.historySearch)),i.axios.post(i.$api.searchKnowledgeFile,{query:e.search,page:e.currentPage,knowledgeId:i.$route.query.id||""}).then(o=>{const{data:s,code:u,msg:h}=o.data;u==0?(s.currentPage===s.totalPage?e.finished=!0:e.currentPage++,e.knowledgeList=s.data||[]):Q(h)}).finally(()=>{e.isShowHistoy=!1,e.loading=!1}))},_=()=>{e.isShowHistoy=!0,e.knowledgeList=[],e.currentPage=1,e.finished=!1},D=o=>{o||_()},B=o=>{e.search=o,c()},E=o=>{ee({title:"\u6E29\u99A8\u63D0\u793A",confirmButtonColor:"#22ad72",message:"\u786E\u8BA4\u5220\u9664\u641C\u7D22\u8BB0\u5F55\u4E48\uFF1F"}).then(()=>{e.historySearch=[],localStorage.removeItem("historySearch")}).catch(()=>{})},L=o=>{i.$router.push({path:"/v2/knowledge/details",query:{knowledgeId:i.$route.query.id,fileId:o._id,name:o.policyName}})};return(o,s)=>{const u=R,h=j,b=K,H=W,N=X,$=Z;return n(),r("div",null,[a("div",te,[d(h,{modelValue:e.search,"onUpdate:modelValue":[s[0]||(s[0]=t=>e.search=t),D],onSearch:c,"show-action":"",shape:"round",onClear:_,placeholder:"\u641C\u7D22\u6587\u4EF6",ref_key:"vanSearchComponent",ref:F},{action:m(()=>[d(u,{class:"search-btn",disabled:!e.search,loading:!1,onClick:c,round:"",type:"success",size:"small","loading-text":"\u641C\u7D22"},{default:m(()=>[Y("\u641C\u7D22")]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),oe,g(a("div",se,[a("div",ae,[ne,d(b,{name:"delete-o",color:"#a9a6a6",class:"search-icon",onClick:s[1]||(s[1]=t=>E(o.index))})]),a("div",ie,[(n(!0),r(y,null,v(e.historySearch,(t,f)=>(n(),r("span",{class:"tag",key:f,onClick:A=>B(t)},M(t),9,re))),128))])],512),[[S,e.isShowHistoy]]),g(a("div",le,[e.knowledgeList.length===0?(n(),r("div",ce,[d(H,{"image-size":"150",description:"\u6CA1\u6709\u627E\u5230\u76F8\u5173\u7684\u6587\u4EF6\u8BB0\u5F55"})])):C("",!0),e.knowledgeList.length!==0?(n(),w($,{key:1,loading:e.loading,"onUpdate:loading":s[2]||(s[2]=t=>e.loading=t),finished:e.finished,"finished-text":"\u6CA1\u6709\u66F4\u591A\u4E86",onLoad:c},{default:m(()=>[a("div",null,[(n(!0),r(y,null,v(e.knowledgeList,(t,f)=>(n(),w(N,{class:"van-clearfix",key:t._id,title:t.sourceFile.fileName,label:z(I)("YYYY-mm-dd HH:MM:SS",t.createTime),onClick:A=>L(t),icon:"description"},null,8,["title","label","onClick"]))),128))])]),_:1},8,["loading","finished"])):C("",!0)],512),[[S,!e.isShowHistoy]])])}}});var we=P(de,[["__scopeId","data-v-da500544"]]);export{we as default};
