import{_ as Q,s as R,r as i,z as F,o as d,l as k,q as l,H as t,T as o,B as p,U as W,y as D,V as X,W as J,X as O,x as S,A as Z,F as q,E as L,D as $,G as g,L as ee,Q as le,v as r,N as te,Y as ae}from"./index.8c5864de.js";const ne={class:"knowledge"},oe={class:"header flex flex_between"},se={key:0},ce={class:"content"},ue={class:"flex"},ie={class:"flex_1"},de={class:"desc"},re={class:"flag"},_e={class:"flex_1",style:{"margin-left":"50px"}},pe={class:"desc"},ve={class:"flag"},me=R({__name:"knowledge",setup(ge){const{appContext:M}=ee(),s=M.config.globalProperties,C=i(""),H=le(),v=i(1),f=i([]),w=i([]),E=s.$common.DateFormat,x=i(0),h=i(!1),b=i(!1),K=i(F.state.role),V=()=>(h.value=!0,b.value=!1,new Promise((a,c)=>{s.axios.post(s.$api.listKnowledgeTable,{page:v.value}).then(y=>{const{data:n,code:_,msg:m}=y.data;if(_==0&&n.data.length>0){let u=Math.ceil(n.data.length/2);f.value=n.data.slice(0,u),w.value=n.data.slice(u),x.value=n.totalCount}else s.$message.error(m)}).finally(()=>{h.value=!1})}));V();const Y=()=>(h.value=!0,new Promise((a,c)=>{s.axios.post(s.$api.searchKnowledgeTable,{page:v.value,query:C.value}).then(y=>{const{data:n,code:_,msg:m}=y.data;if(_==0){let u=Math.ceil(n.data.length/2);f.value=n.data.slice(0,u),w.value=n.data.slice(u),x.value=n.totalCount}else s.$message.error(m)}).finally(()=>{h.value=!1})})),P=()=>{!C.value||(f.value=[],w.value=[],x.value=0,v.value=1,b.value=!0,Y())},A=a=>{console.log(a),v.value=a,b.value?Y():V()},B=a=>{F.state.user.role==="Admin"?s.$router.push({path:"/v2/knowledge/upload",query:{id:a.uniqueId,name:a.knowledgeName,type:a.type}}):s.$router.push({path:"/v2/knowledge/check",query:{id:a.uniqueId,name:a.knowledgeName,type:a.type}})};return(a,c)=>{const y=r("el-icon"),n=r("el-input"),_=r("el-button"),m=te,u=r("el-card"),N=r("el-timeline-item"),T=r("el-timeline"),I=r("el-pagination"),j=r("el-empty"),U=ae("loading");return d(),k("div",ne,[l("div",oe,[l("div",null,[t(n,{modelValue:C.value,"onUpdate:modelValue":c[0]||(c[0]=e=>C.value=e),class:"search-input",clearable:"",placeholder:"\u77E5\u8BC6\u5E93\u641C\u7D22"},{prefix:o(()=>[t(y,{class:"el-input__icon"},{default:o(()=>[t(p(W))]),_:1})]),_:1},8,["modelValue"]),t(_,{class:"default-primary",type:"primary",icon:p(X),onClick:P},{default:o(()=>[D("\u641C\u7D22")]),_:1},8,["icon"]),t(_,{class:"default-primary-plain",icon:p(J),onClick:V},{default:o(()=>[D("\u91CD\u5236")]),_:1},8,["icon"])]),K.value==="Admin"?(d(),k("div",se,[t(_,{class:"default-primary",type:"primary",onClick:c[1]||(c[1]=e=>p(H).push({path:"/v2/knowledge/new"})),icon:p(O)},{default:o(()=>[D("\u65B0\u5EFA")]),_:1},8,["icon"])])):S("",!0)]),Z((d(),k("div",ce,[l("div",ue,[l("div",ie,[t(T,null,{default:o(()=>[(d(!0),k(q,null,L(f.value,(e,G)=>(d(),$(N,{key:e.createTime,timestamp:p(E)("YYYY-mm-dd HH:MM:SS",e.createTime),color:"#0bbd87",placement:"top"},{default:o(()=>[t(u,{class:"content-item",onClick:z=>B(e)},{default:o(()=>[l("h4",null,g(e.knowledgeName),1),l("p",de,g(e.desc),1),l("div",re,[t(m,{"icon-class":"flag",color:e.type==="public"?"#409eff":"#65ba95",class:"icon"},null,8,["color"]),l("span",null,g(e.type==="public"?"\u516C\u5F00":"\u79C1\u6709"),1)])]),_:2},1032,["onClick"])]),_:2},1032,["timestamp"]))),128))]),_:1})]),l("div",_e,[t(T,null,{default:o(()=>[(d(!0),k(q,null,L(w.value,(e,G)=>(d(),$(N,{key:e.createTime,timestamp:p(E)("YYYY-mm-dd HH:MM:SS",e.createTime),color:"#0bbd87",placement:"top"},{default:o(()=>[t(u,{class:"content-item",onClick:z=>B(e)},{default:o(()=>[l("h4",null,g(e.knowledgeName),1),l("p",pe,g(e.desc),1),l("div",ve,[t(m,{"icon-class":"flag",color:e.type==="public"?"#409eff":"#65ba95",class:"icon"},null,8,["color"]),l("span",null,g(e.type==="public"?"\u516C\u5F00":"\u79C1\u6709"),1)])]),_:2},1032,["onClick"])]),_:2},1032,["timestamp"]))),128))]),_:1})])]),t(I,{modelValue:v.value,"onUpdate:modelValue":c[2]||(c[2]=e=>v.value=e),class:"pagination flex_just",background:"",layout:"total,prev, pager, next",total:x.value,onCurrentChange:A,"hide-on-single-page":""},null,8,["modelValue","total"]),f.value.length===0?(d(),$(j,{key:0,description:"\u6682\u65E0\u77E5\u8BC6\u5E93\u6570\u636E"})):S("",!0)])),[[U,h.value]])])}}});var he=Q(me,[["__scopeId","data-v-2461d60f"]]);export{he as default};
