!function(){var e=document.createElement("style");e.innerHTML=".container-padding[data-v-11c1ff0c]{padding-bottom:160px}.container[data-v-11c1ff0c]{position:relative;width:100%;height:100%;background:#fff;box-sizing:border-box;overflow:hidden;margin-top:-25px}.container .upload[data-v-11c1ff0c]{margin:0 auto}.container .upload[data-v-11c1ff0c] .el-upload-dragger{background:#f1f5f4;border:none;padding:28px 0;margin-top:-18px}.container .upload[data-v-11c1ff0c] .el-upload-dragger .el-upload__text{color:#000}.container .upload[data-v-11c1ff0c] .el-upload-dragger .el-upload__tip{color:#a7a7a7}.container .upload[data-v-11c1ff0c] .el-upload-dragger .el-icon,.container .upload[data-v-11c1ff0c] .el-upload-dragger em{color:#12aa7e}.container .upload[data-v-11c1ff0c] .el-upload-dragger:hover{border-color:#12aa7e}.container .button-upload[data-v-11c1ff0c]{position:absolute;right:0px;bottom:0px;text-align:right}[data-v-11c1ff0c] .upload{position:relative}[data-v-11c1ff0c] .upload .el-upload-list{position:absolute;width:100%;left:0;overflow:auto;margin-top:42px;height:106px;background:#f7faf9;padding-top:10px}[data-v-11c1ff0c] .upload .el-upload-list .el-upload-list__item{margin:5px 0;font-size:12px}.el-upload-title[data-v-11c1ff0c]{width:100%;height:30px;line-height:30px;background:#f7faf9;color:#555;font-size:13px;margin-top:10px;padding:0 10px;box-sizing:border-box}.default-primary[data-v-11c1ff0c]{background:#12aa7e;border:none}.default-primary[data-v-11c1ff0c]:hover{opacity:.8}.default-primary-plain[data-v-11c1ff0c]{border:solid 1px #f1f5f4}.default-primary-plain[data-v-11c1ff0c]:hover{background:#f1f5f4;color:#12aa7e}[data-v-09b2e8b8] .seltAllbtnDis .cell{visibility:hidden}.knowledge .search-input[data-v-09b2e8b8]{width:300px;margin-right:20px}.knowledge .header[data-v-09b2e8b8]{padding:15px 0 10px}.knowledge .header .line-icon[data-v-09b2e8b8]{display:inline-block;width:4px;height:20px;background-color:#1996fc;border-radius:2px;margin-right:10px}.knowledge .header .title[data-v-09b2e8b8]{margin-right:30px}.knowledge .header .title span[data-v-09b2e8b8]{display:inline-block;height:30px;line-height:30px;background-color:#f3f4f6;padding:0 20px;color:#555;border-radius:2px;font-size:14px;font-weight:800;border:1px solid #f0f0f0}.knowledge .content[data-v-09b2e8b8]{text-align:center;padding-top:10px}.knowledge .content .table[data-v-09b2e8b8]{border-top:1px solid #f0f0f0;border-left:1px solid #f0f0f0;border-right:1px solid #f0f0f0}.knowledge .content[data-v-09b2e8b8] .el-table__row{cursor:pointer}.knowledge .content .pagination[data-v-09b2e8b8]{margin-top:40px}.knowledge .default-primary[data-v-09b2e8b8]{background:#12aa7e;border:none}.knowledge .default-primary-plain[data-v-09b2e8b8]{border:solid 1px #f1f5f4}.knowledge .default-primary-plain[data-v-09b2e8b8]:hover{background:#f1f5f4;color:#12aa7e}.knowledge[data-v-09b2e8b8] .el-input__wrapper.is-focus{box-shadow:0 0 0 1px #12aa7e inset!important}.knowledge[data-v-09b2e8b8] .el-pagination li.is-active{background:#12aa7e}.knowledge[data-v-09b2e8b8] .el-pagination li:hover{color:#12aa7e}.knowledge-title[data-v-09b2e8b8]{margin-top:5px;color:#555;font-weight:600;font-size:18px}.knowledge-title span[data-v-09b2e8b8]:nth-child(2){margin-left:5px}\n",document.head.appendChild(e),System.register(["./index-legacy.77e40bdf.js"],(function(e){"use strict";var a,l,t,o,n,d,i,r,p,u,c,s,f,g,v,b,m,h,x,y,w,k,_,$,C,q,F,z,I,U,R;return{setters:[function(e){a=e._,l=e.s,t=e.r,o=e.v,n=e.Y,d=e.A,i=e.B,r=e.o,p=e.l,u=e.H,c=e.T,s=e.a4,f=e.x,g=e.y,v=e.C,b=e.L,m=e.z,h=e.p,x=e.m,y=e.q,w=e.G,k=e.U,_=e.V,$=e.W,C=e.a1,q=e.a5,F=e.a2,z=e.a6,I=e.F,U=e.Q,R=e.a3}],execute:function(){const T=e=>(h("data-v-11c1ff0c"),e=e(),x(),e),V=T((()=>y("div",{class:"el-upload__text"},[g("将制度文件拖到此处，或"),y("em",null,"点击上传")],-1))),L=T((()=>y("div",{class:"el-upload__tip"},"支持上传wps/doc/docx/pdf/zip/gz/gd/ofd等文件",-1))),P={key:0,class:"el-upload-title"},S=[T((()=>y("span",null,"文件名称",-1)))],N={key:1,class:"button-upload"},Y=l({__name:"UploadComponent",emits:["uploadFinished"],setup(e,{emit:a}){const{appContext:l}=b(),h=l.config.globalProperties;let x=t([]),y=t(null);const w=(e,a)=>{if(console.log(e,a),x.value.some((a=>a.name==e.name)))return h.$message({message:e.name+" 已存在",type:"warning"}),void y.value.uploadFiles.splice(y.value.uploadFiles.length-1,1);x.value.push(e)},k=(e,a)=>{x.value=a},_=()=>{0!==x.value.length?q():h.$message({message:"上传文件不能为空",type:"warning"})};let $=t(!1),C=t(0);const q=()=>{$.value=!0;let e=new FormData;for(let a=0;a<x.value.length;a++)console.log(x.value[a].raw),e.append("file",x.value[a].raw);e.append("token",m.state.user.token),e.append("knowledgeId",h.$route.query.id||""),h.axios.post(h.$api.uploadFile,e,{headers:{"Content-Type":"multipart/form-data"},timeout:6e5,transformRequest:[function(e){return e}]}).then((e=>{$.value=!1;let{code:l,msg:t}=e.data;0==l?(C.value=0,x.value=[],h.$message.success("文件上传成功"),a("uploadFinished")):h.$message({message:t,type:"warning"})})).catch((()=>{$.value=!1}))};return(e,a)=>{const l=o("el-icon"),t=o("el-upload"),b=o("el-button"),m=n("loading");return d((r(),p("div",{class:v([{"container-padding":i(x).length>0},"container"])},[u(t,{ref_key:"upload",ref:y,class:"upload",drag:"",multiple:"",action:"customize","auto-upload":!1,"on-change":w,"on-remove":k,"show-file-list":!0,"file-list":i(x),accept:".wps,.doc,.docx,.pdf,.zip,.gz"},{default:c((()=>[u(l,{size:60,color:"#409eff",style:{"margin-bottom":"15px"}},{default:c((()=>[u(i(s))])),_:1}),V,L])),_:1},8,["file-list"]),i(x).length>0?(r(),p("div",P,S)):f("",!0),i(x).length>0?(r(),p("div",N,[u(b,{class:"btn1 btn default-primary",type:"primary",onClick:_},{default:c((()=>[u(l,null,{default:c((()=>[u(i(s))])),_:1}),g(" 立即上传 ")])),_:1})])):f("",!0)],2)),[[m,i($)]])}}});var j=a(Y,[["__scopeId","data-v-11c1ff0c"]]);const A=e=>(h("data-v-09b2e8b8"),e=e(),x(),e),B={class:"knowledge"},D={key:0,class:"knowledge-title"},H=A((()=>y("span",null,"知识库名称: ",-1))),O={class:"header flex flex_between"},M={class:"flex flex_center"},E={class:"content"},J=A((()=>y("span",null,"暂无数据，返回",-1))),K=A((()=>y("span",null,"选择",-1)));e("default",a(l({__name:"upload",setup(e){const a=t(""),l=t(!1),{appContext:n}=b(),d=n.config.globalProperties,s=U(),v=t(1),m=t([]),h=d.$common.DateFormat,x=t(0),T=t(!1),V=t(!1),L=t(d.$route.query.type||""),P=t(d.$route.query.name||""),S=t(),N=t([]),Y=e=>{N.value=e,console.log(e)},A=({columnIndex:e})=>{if(0===e&&"public"===L.value||0===e&&!d.$route.query.id)return"seltAllbtnDis"},G=()=>(T.value=!0,V.value=!1,new Promise(((e,a)=>{d.axios.post(d.$api.listKnowledgeFile,{page:v.value,knowledgeId:d.$route.query.id||""}).then((e=>{const{data:a,code:l,msg:t}=e.data;0==l?(m.value=a.data,x.value=a.totalCount):d.$message.error(t)})).finally((()=>{T.value=!1}))})));G();const Q=()=>{v.value=1,G()},W=()=>(T.value=!0,new Promise(((e,l)=>{d.axios.post(d.$api.searchKnowledgeFile,{page:v.value,query:a.value,knowledgeId:d.$route.query.id||""}).then((e=>{const{data:a,code:l,msg:t}=e.data;0==l?(m.value=a.data,x.value=a.totalCount):d.$message.error(t)})).finally((()=>{T.value=!1}))}))),X=()=>{a.value&&(m.value=[],x.value=0,v.value=1,V.value=!0,W())},Z=e=>{v.value=e,ee()},ee=()=>{V.value?W():G()},ae=e=>e+1+10*(v.value-1),le=e=>{let a=d.$router.resolve({path:"/v2/knowledge/details",query:{knowledgeId:d.$route.query.id,fileId:e._id,name:e.policyName}});window.open(a.href,"_bank")},te=e=>{"delete"===e?R.confirm("您将删除此知识库，是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(()=>{T.value=!0;let e=N.value.map((e=>e._id));new Promise(((a,l)=>{d.axios.post(d.$api.delFile,{knowledgeId:d.$route.query.id,policy_id:JSON.stringify(e)}).then((e=>{const{data:a,code:l,msg:t}=e.data;0==l?(d.$message.success("删除成功"),ee()):d.$message.error(t)})).finally((()=>{T.value=!1}))}))})()})):"download"===e&&(()=>{let e=N.value.map((e=>e.sourceFile));new Promise(((a,l)=>{d.axios.post(d.$api.downloadFile,{knowledgeId:d.$route.query.id,ids:JSON.stringify(e)},{responseType:"blob"}).then((a=>{const l=a.data,t=new Blob([l],{type:a.data.type}),o=document.createElement("a"),n=window.URL.createObjectURL(t);o.href=n,e.length>1?o.download=decodeURI(d.$route.query.name+".zip"):o.download=decodeURI(e[0].fileName),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(n)})).finally((()=>{T.value=!1}))}))})()},oe=()=>{s.push({path:"/v2/knowledge/index"})};return(e,t)=>{const n=o("el-icon"),s=o("el-input"),v=o("el-button"),b=o("el-table-column"),U=o("el-table"),R=o("el-pagination"),T=o("el-dialog");return r(),p(I,null,[y("div",B,[P.value?(r(),p("div",D,[H,y("span",null,w(P.value),1)])):f("",!0),y("div",O,[y("div",M,[y("div",null,[u(s,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),class:"search-input",placeholder:"文件搜索"},{prefix:c((()=>[u(n,{class:"el-input__icon"},{default:c((()=>[u(i(k))])),_:1})])),_:1},8,["modelValue"]),u(v,{class:"default-primary",type:"primary",icon:i(_),onClick:X},{default:c((()=>[g(" 搜索")])),_:1},8,["icon"]),u(v,{class:"default-primary-plain",icon:i($),onClick:G},{default:c((()=>[g("重制")])),_:1},8,["icon"])])]),y("div",null,[u(v,{type:"primary",onClick:t[1]||(t[1]=C((e=>te("download")),["stop"])),disabled:0===N.value.length,icon:i(q),circle:""},null,8,["disabled","icon"]),u(v,{type:"danger",icon:i(F),onClick:t[2]||(t[2]=C((e=>te("delete")),["stop"])),disabled:0===N.value.length,circle:""},null,8,["icon","disabled"]),u(v,{class:"default-primary",type:"primary",onClick:t[3]||(t[3]=e=>l.value=!0),icon:i(z),disabled:"public"===L.value||!i(d).$route.query.id,circle:""},null,8,["icon","disabled"])])]),y("div",E,[u(U,{ref_key:"multipleTableRef",ref:S,"cell-style":{textAlign:"center"},stripe:"",class:"table","header-cell-style":{"text-align":"center"},data:m.value,onRowClick:le,onSelectionChange:Y,"header-cell-class-name":A},{empty:c((()=>[y("div",null,[J,y("span",{onClick:oe,style:{color:"#409eff",cursor:"pointer",margin:"0 2px"}},"知识库列表"),K])])),default:c((()=>[u(b,{type:"selection",selectable:()=>"public"!==L.value,width:"55"},null,8,["selectable"]),u(b,{type:"index",index:ae,width:"100",label:"序号"}),u(b,{property:"sourceFile.fileName",label:"制度名称"}),u(b,{label:"上传时间"},{default:c((e=>[g(w(i(h)("YYYY-mm-dd HH:MM:SS",e.row.createTime)),1)])),_:1})])),_:1},8,["data"]),u(R,{class:"pagination flex_just",background:"",layout:"total,prev, pager, next",onCurrentChange:Z,"hide-on-single-page":"",total:x.value},null,8,["total"])])]),u(T,{modelValue:l.value,"onUpdate:modelValue":t[4]||(t[4]=e=>l.value=e),title:"文件上传",width:"40%"},{default:c((()=>[u(j,{onUploadFinished:Q})])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-09b2e8b8"]]))}}}))}();
